unit Unit1;

interface

uses
  System.SysUtils, System.Classes, Data.DB, Data.Win.ADODB;

type
  TDataModule1 = class(TDataModule)
    ADOConnection1: TADOConnection;
    TNatteam: TADOTable;
    TFootballer: TADOTable;
    TClub: TADOTable;
    DSFootballer: TDataSource;
    DSClub: TDataSource;
    DSNatteam: TDataSource;
    procedure TFootballerFilterRecord(DataSet: TDataSet; var Accept: Boolean);
    procedure TNatteamFilterRecord(DataSet: TDataSet; var Accept: Boolean);
    procedure TClubFilterRecord(DataSet: TDataSet; var Accept: Boolean);
  private
    { Private declarations }
  public
    ed: String;
    { Public declarations }
  end;

var
  DataModule1: TDataModule1;

implementation

{%CLASSGROUP 'Vcl.Controls.TControl'}

uses SDIMAIN;

{$R *.dfm}

procedure TDataModule1.TClubFilterRecord(DataSet: TDataSet;
  var Accept: Boolean);
var   s:String;
begin
	if SDIAppForm.ComboBox2.ItemIndex=0 then
	begin
		s:=Copy(DataSet['Club'],1,Length(ed));
		Accept:=s=ed;
	end
	else if SDIAppForm.Combobox2.ItemIndex=1 then
	begin
		s:=Copy(DataSet['Place'],1,Length(ed));
		Accept:=s=ed;
	end;
end;

procedure TDataModule1.TFootballerFilterRecord(DataSet: TDataSet;
  var Accept: Boolean);
var   s:String;
begin
	if SDIAppForm.ComboBox2.ItemIndex=0 then
	begin // если поиск по полю Name
		s:=Copy(DataSet['Name'],1,Length(ed));  //копирование из поля DataSet['Name'] в s с 1 по Length(ed)  символы.
		Accept:=s=ed;  //если скопированная строка s = ed, то записи в таблице имеются, иначе нет.
	end
	else if SDIAppForm.Combobox2.ItemIndex=1 then
	begin // если поиск по полю Natteam
		s:=Copy(DataSet['Natteam'],1,Length(ed)); // аналогично
		Accept:=s=ed;
	end
	else if SDIAppForm.Combobox2.ItemIndex=2 then
	begin // если поиск по полю Club
		s:=Copy(DataSet['Club'],1,Length(ed)); // аналогично
		Accept:=s=ed;
	end;
end;



procedure TDataModule1.TNatteamFilterRecord(DataSet: TDataSet;
  var Accept: Boolean);
var   s:String;
begin
	if SDIAppForm.ComboBox2.ItemIndex=0 then
	begin
		s:=Copy(DataSet['Natteam'],1,Length(ed));
		Accept:=s=ed;
	end
	else if SDIAppForm.Combobox2.ItemIndex=1 then
	begin
		s:=Copy(DataSet['Place'],1,Length(ed));
		Accept:=s=ed;
	end;
end;

end.
